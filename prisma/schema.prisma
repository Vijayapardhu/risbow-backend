generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model AbandonedCheckout {
  id                                   String                 @id
  userId                               String?
  guestInfo                            Json?
  cartSnapshot                         Json
  financeSnapshot                      Json
  metadata                             Json?
  status                               CheckoutRecoveryStatus @default(NEW)
  agentId                              String?
  lockedUntil                          DateTime?
  createdAt                            DateTime               @default(now())
  abandonedAt                          DateTime               @default(now())
  updatedAt                            DateTime
  abandonReason                        String?
  lastErrorCode                        String?
  paymentMethod                        String?
  User_AbandonedCheckout_agentIdToUser User?                  @relation("AbandonedCheckout_agentIdToUser", fields: [agentId], references: [id])
  User_AbandonedCheckout_userIdToUser  User?                  @relation("AbandonedCheckout_userIdToUser", fields: [userId], references: [id])
  CheckoutFollowup                     CheckoutFollowup[]
  Order                                Order[]

  @@index([abandonedAt])
  @@index([agentId])
  @@index([status, agentId])
  @@index([status])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Address {
  id           String     @id
  userId       String
  title        String?
  name         String
  mobile       String?
  street       String?
  city         String
  state        String
  pincode      String
  isDefault    Boolean    @default(false)
  addressLine1 String     @default("")
  addressLine2 String?
  createdAt    DateTime   @default(now())
  label        String     @default("Home")
  phone        String
  updatedAt    DateTime
  latitude     Float?
  longitude    Float?
  geoSource    GeoSource?
  geoUpdatedAt DateTime?
  User         User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  Order        Order[]

  @@index([userId])
}

model Admin {
  id            String          @id
  email         String          @unique
  password      String
  role          String
  createdAt     DateTime        @default(now())
  avatar        String?
  isActive      Boolean         @default(true)
  lastLoginAt   DateTime?
  name          String?
  updatedAt     DateTime
  BlogPost      BlogPost[]
  SupportTicket SupportTicket[]

  @@index([isActive])
  @@index([role])
}

/// AdminUser model for admin authentication system
model AdminUser {
  id             String         @id @default(uuid())
  email          String         @unique
  password       String         // Also serves as passwordHash
  name           String
  role           AdminRole      @default(OPERATIONS_ADMIN)
  isActive       Boolean        @default(true)
  isMfaEnabled   Boolean        @default(false)
  mfaSecret      String?
  backupCodes    String[]       @default([]) // MFA backup codes
  avatar         String?
  lastLoginAt    DateTime?
  failedAttempts Int            @default(0)
  lockedUntil    DateTime?
  createdAt      DateTime       @default(now())
  updatedAt      DateTime       @updatedAt
  AdminSession   AdminSession[]
  AdminAction    AdminAction[]

  @@index([email])
  @@index([role])
  @@index([isActive])
}

/// AdminSession model for session management
model AdminSession {
  id          String     @id @default(uuid())
  adminUserId String
  token       String     @unique
  ipAddress   String?
  userAgent   String?
  isActive    Boolean    @default(true)
  expiresAt   DateTime
  lastActive  DateTime   @default(now())
  createdAt   DateTime   @default(now())
  AdminUser   AdminUser  @relation(fields: [adminUserId], references: [id], onDelete: Cascade)

  @@index([adminUserId])
  @@index([token])
  @@index([expiresAt])
}

/// AdminAction model for audit logging
model AdminAction {
  id           String    @id @default(uuid())
  adminId      String    // Match the field name code expects
  action       String
  entity       String?
  entityId     String?
  resourceType String?   // For filtering by resource type
  changes      Json?
  ipAddress    String?
  userAgent    String?
  createdAt    DateTime  @default(now()) // Code expects createdAt not timestamp
  AdminUser    AdminUser @relation(fields: [adminId], references: [id], onDelete: Cascade)

  @@index([adminId])
  @@index([action])
  @@index([entity])
  @@index([resourceType])
  @@index([createdAt])
}

/// OrderItem model for individual order line items
model OrderItem {
  id          String   @id @default(uuid())
  orderId     String
  productId   String
  vendorId    String
  quantity    Int
  price       Int
  offerPrice  Int?
  subtotal    Int
  tax         Int      @default(0)
  discount    Int      @default(0)
  total       Int
  status      String   @default("PENDING")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  Order       Order    @relation(fields: [orderId], references: [id], onDelete: Cascade)
  Product     Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
  Vendor      Vendor   @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@index([orderId])
  @@index([productId])
  @@index([vendorId])
  @@index([status])
}

/// CoinTransaction model for coin transaction tracking
model CoinTransaction {
  id            String   @id @default(uuid())
  userId        String
  amount        Int
  type          String // EARNED, SPENT, EXPIRED, REFUNDED
  reason        String?
  referenceId   String?
  referenceType String?
  balanceBefore Int
  balanceAfter  Int
  expiresAt     DateTime?
  status        String   @default("COMPLETED")
  createdAt     DateTime @default(now())
  metadata      Json?

  @@index([userId])
  @@index([type])
  @@index([createdAt])
  @@index([expiresAt])
  @@index([status])
}

/// BannerPricing model for banner campaign pricing
model BannerPricing {
  id           String   @id @default(uuid())
  position     String
  duration     Int // in days
  pricePerDay  Int
  minDuration  Int      @default(1)
  maxDuration  Int      @default(30)
  isActive     Boolean  @default(true)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([position])
  @@index([isActive])
}

/// BannerMetric model for banner performance tracking
model BannerMetric {
  id                String   @id @default(uuid())
  campaignId        String
  date              DateTime
  impressions       Int      @default(0)
  clicks            Int      @default(0)
  conversions       Int      @default(0)
  revenue           Int      @default(0)
  cost              Int      @default(0)
  clickThroughRate  Float    @default(0)
  conversionRate    Float    @default(0)
  returnOnAdSpend   Float    @default(0)
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@index([campaignId])
  @@index([date])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model AdminNote {
  id                           String   @id
  userId                       String
  adminId                      String
  note                         String
  createdAt                    DateTime @default(now())
  User_AdminNote_adminIdToUser User     @relation("AdminNote_adminIdToUser", fields: [adminId], references: [id])
  User_AdminNote_userIdToUser  User     @relation("AdminNote_userIdToUser", fields: [userId], references: [id])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model AuditLog {
  id        String   @id
  adminId   String
  entity    String
  action    String
  details   Json?
  createdAt DateTime @default(now())
  entityId  String
  ipAddress String?
  userAgent String?
  User      User     @relation(fields: [adminId], references: [id])

  @@index([action])
  @@index([adminId])
  @@index([createdAt])
  @@index([entity])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Banner {
  id                     String                   @id
  vendorId               String?
  imageUrl               String
  redirectUrl            String?
  slotType               String
  startDate              DateTime
  endDate                DateTime
  isActive               Boolean                  @default(true)
  createdAt              DateTime                 @default(now())
  metadata               Json?
  bannerCampaignId       String?
  BannerImpressionLedger BannerImpressionLedger[]

  @@index([slotType, isActive])
  @@index([slotType, startDate, endDate, isActive])
  @@index([startDate, endDate])
  @@index([vendorId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model BannerCampaign {
  id             String   @id
  bannerId       String
  vendorId       String
  campaignType   String
  position       String?  // Position for filtering
  status         String   @default("PENDING") // Status field for campaign state
  targetAudience String
  startDate      DateTime
  endDate        DateTime
  amountPaid     Int
  paymentStatus  String   @default("PENDING")
  createdAt      DateTime @default(now())

  @@index([startDate, endDate])
  @@index([vendorId])
  @@index([position])
  @@index([status])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model BannerImpressionLedger {
  id        String    @id
  bannerId  String
  userId    String?
  viewedAt  DateTime  @default(now())
  clickedAt DateTime?
  Banner    Banner    @relation(fields: [bannerId], references: [id], onDelete: Cascade)
  User      User?     @relation(fields: [userId], references: [id])

  @@index([bannerId, viewedAt])
  @@index([userId, viewedAt])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Bet {
  id             String        @id
  userId         String
  idempotencyKey String        @unique
  type           BetType       @default(SINGLE)
  selections     Json
  stake          Int
  odds           Float
  potentialWin   Int
  status         BetStatus     @default(PENDING)
  placedAt       DateTime      @default(now())
  settledAt      DateTime?
  result         String?
  payout         Int?
  createdAt      DateTime      @default(now())
  updatedAt      DateTime
  User           User          @relation(fields: [userId], references: [id])
  LedgerEntry    LedgerEntry[]

  @@index([idempotencyKey])
  @@index([status])
  @@index([userId])
}

model BlogCategory {
  id                 String         @id
  slug               String         @unique
  name               String
  description        String?
  image              String?
  parentId           String?
  sortOrder          Int            @default(0)
  isActive           Boolean        @default(true)
  createdAt          DateTime       @default(now())
  BlogCategory       BlogCategory?  @relation("BlogCategoryToBlogCategory", fields: [parentId], references: [id])
  other_BlogCategory BlogCategory[] @relation("BlogCategoryToBlogCategory")
  BlogPost           BlogPost[]

  @@index([isActive])
  @@index([parentId])
  @@index([slug])
}

model BlogPost {
  id           String        @id
  slug         String        @unique
  title        String
  excerpt      String?
  content      String
  coverImage   String?
  categoryId   String?
  authorId     String
  tags         String[]
  status       PostStatus    @default(DRAFT)
  isFeatured   Boolean       @default(false)
  publishedAt  DateTime?
  viewCount    Int           @default(0)
  readTime     Int?
  seoTitle     String?
  seoDesc      String?
  createdAt    DateTime      @default(now())
  updatedAt    DateTime
  Admin        Admin         @relation(fields: [authorId], references: [id])
  BlogCategory BlogCategory? @relation(fields: [categoryId], references: [id])

  @@index([authorId])
  @@index([categoryId])
  @@index([isFeatured])
  @@index([publishedAt])
  @@index([slug])
  @@index([status])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model BowActionLog {
  id                String        @id
  userId            String
  actionType        BowActionType
  productId         String?
  variantId         String?
  quantity          Int?
  price             Int?
  reason            String
  guardrailCheck    Json?
  autoReversed      Boolean       @default(false)
  reverseReason     String?
  attributedRevenue Int?
  createdAt         DateTime      @default(now())
  reversedAt        DateTime?
  Product           Product?      @relation(fields: [productId], references: [id])
  User              User          @relation(fields: [userId], references: [id])

  @@index([actionType])
  @@index([autoReversed])
  @@index([createdAt])
  @@index([productId])
  @@index([userId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model BowInteraction {
  id              String          @id
  userId          String
  sessionId       String
  type            InteractionType
  query           String?
  response        String?
  intent          String?
  confidence      Float?
  actionType      BowActionType?
  actionPayload   Json?
  metadata        Json?
  context         Json?
  sentiment       String?
  escalated       Boolean         @default(false)
  createdAt       DateTime        @default(now())
  conversionEvent String?
  conversionValue Int?
  User            User            @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([escalated])
  @@index([sessionId, createdAt])
  @@index([sessionId])
  @@index([userId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model BuyLater {
  id               String   @id
  userId           String
  productId        String
  variantId        String?
  targetPrice      Int
  currentPrice     Int
  quantity         Int      @default(1)
  isActive         Boolean  @default(true)
  isNotified       Boolean  @default(false)
  isAddedToCart    Boolean  @default(false)
  priceDropPercent Float?
  createdAt        DateTime @default(now())
  updatedAt        DateTime
  Product          Product  @relation(fields: [productId], references: [id])
  User             User     @relation(fields: [userId], references: [id])

  @@index([createdAt])
  @@index([isActive])
  @@index([isNotified])
  @@index([productId])
  @@index([userId])
}

model CMSMenu {
  id          String        @id
  name        String        @unique
  location    MenuLocation
  isActive    Boolean       @default(true)
  createdAt   DateTime      @default(now())
  updatedAt   DateTime
  CMSMenuItem CMSMenuItem[]

  @@index([isActive])
  @@index([location])
}

model CMSMenuItem {
  id                String        @id
  menuId            String
  label             String
  url               String
  icon              String?
  target            String        @default("_self")
  parentId          String?
  sortOrder         Int           @default(0)
  isActive          Boolean       @default(true)
  CMSMenu           CMSMenu       @relation(fields: [menuId], references: [id], onDelete: Cascade)
  CMSMenuItem       CMSMenuItem?  @relation("CMSMenuItemToCMSMenuItem", fields: [parentId], references: [id])
  other_CMSMenuItem CMSMenuItem[] @relation("CMSMenuItemToCMSMenuItem")

  @@index([menuId])
  @@index([parentId])
  @@index([sortOrder])
}

model CMSPage {
  id            String   @id
  slug          String   @unique
  title         String
  content       String
  excerpt       String?
  metaTitle     String?
  metaDesc      String?
  featuredImage String?
  template      String   @default("default")
  isActive      Boolean  @default(true)
  sortOrder     Int      @default(0)
  createdBy     String
  createdAt     DateTime @default(now())
  updatedAt     DateTime

  @@index([isActive])
  @@index([slug])
  @@index([sortOrder])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Cart {
  id        String     @id
  userId    String     @unique
  updatedAt DateTime
  User      User       @relation(fields: [userId], references: [id])
  CartItem  CartItem[]

  @@index([userId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model CartInsight {
  id              String          @id
  userId          String
  cartValue       Int
  itemCount       Int
  categories      String[]
  cartPattern     String
  hesitationScore Float
  abandonRisk     Float
  resolvedAt      DateTime?
  severity        InsightSeverity
  triggeredAt     DateTime        @default(now())
  type            CartInsightType
  User            User            @relation(fields: [userId], references: [id])

  @@index([cartPattern])
  @@index([severity])
  @@index([triggeredAt])
  @@index([type])
  @@index([userId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model CartItem {
  id        String  @id
  cartId    String
  productId String
  variantId String?
  quantity  Int
  Cart      Cart    @relation(fields: [cartId], references: [id])
  Product   Product @relation(fields: [productId], references: [id])

  @@index([cartId])
  @@index([productId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Category {
  id                 String              @id
  name               String
  image              String?
  nameTE             String?
  parentId           String?
  createdAt          DateTime            @default(now())
  updatedAt          DateTime
  attributeSchema    Json?
  isActive           Boolean             @default(true)
  Category           Category?           @relation("CategoryToCategory", fields: [parentId], references: [id])
  other_Category     Category[]          @relation("CategoryToCategory")
  CategoryCommission CategoryCommission?
  CommissionRule     CommissionRule[]
  CategorySpec       CategorySpec[]
  LocalPromotion     LocalPromotion[]
  Product            Product[]
  ProductSearchMiss  ProductSearchMiss[]

  @@index([isActive])
  @@index([parentId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model CategoryCommission {
  id             String   @id
  categoryId     String   @unique
  commissionRate Float
  isActive       Boolean  @default(true)
  createdAt      DateTime @default(now())
  Category       Category @relation(fields: [categoryId], references: [id])
}

/// CommissionRule - rule-based commission overrides for product/vendor/category/global
model CommissionRule {
  id             String          @id
  scope          CommissionScope
  commissionRate Float
  isActive       Boolean         @default(true)
  effectiveFrom  DateTime        @default(now())
  effectiveTo    DateTime?
  vendorId       String?
  categoryId     String?
  productId      String?
  reason         String?
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  Vendor         Vendor?         @relation(fields: [vendorId], references: [id])
  Category       Category?       @relation(fields: [categoryId], references: [id])
  Product        Product?        @relation(fields: [productId], references: [id])

  @@index([scope, isActive])
  @@index([vendorId])
  @@index([categoryId])
  @@index([productId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model CategorySpec {
  id               String             @id
  categoryId       String
  key              String
  label            String
  labelTE          String?
  type             SpecType
  unit             String?
  required         Boolean            @default(false)
  options          Json?
  sortOrder        Int                @default(0)
  isActive         Boolean            @default(true)
  createdAt        DateTime           @default(now())
  updatedAt        DateTime
  Category         Category           @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  ProductSpecValue ProductSpecValue[]

  @@unique([categoryId, key])
  @@index([categoryId, isActive])
  @@index([categoryId, sortOrder])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model CheckoutFollowup {
  id                String            @id
  checkoutId        String
  agentId           String
  note              String
  outcome           CallOutcome?
  createdAt         DateTime          @default(now())
  User              User              @relation(fields: [agentId], references: [id])
  AbandonedCheckout AbandonedCheckout @relation(fields: [checkoutId], references: [id])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model CheckoutGroup {
  id               String              @id
  userId           String
  provider         String              @default("RAZORPAY")
  providerOrderId  String?
  totalAmountPaise Int
  currency         String              @default("INR")
  status           CheckoutGroupStatus @default(PENDING_PAYMENT)
  createdAt        DateTime            @default(now())
  updatedAt        DateTime
  User             User                @relation(fields: [userId], references: [id], onDelete: Cascade)
  Order            Order[]

  @@index([providerOrderId])
  @@index([userId, createdAt])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model ClearanceProduct {
  id             String   @id
  productId      String
  vendorId       String
  clearancePrice Int
  originalPrice  Int
  expiryDate     DateTime
  quantity       Int
  isActive       Boolean  @default(true)
  createdAt      DateTime @default(now())
  Product        Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
  Vendor         Vendor   @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@index([expiryDate, isActive])
  @@index([vendorId, isActive])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model CoinLedger {
  id                String    @id
  userId            String
  amount            Int
  source            String
  referenceId       String?
  expiresAt         DateTime?
  createdAt         DateTime  @default(now())
  isExpired         Boolean   @default(false)
  paisePerCoinAtTxn Int       @default(100)
  roleAtTxn         UserRole  @default(CUSTOMER)
  User              User      @relation(fields: [userId], references: [id])

  @@index([createdAt])
  @@index([expiresAt])
  @@index([isExpired])
  @@index([roleAtTxn, createdAt])
  @@index([userId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model CoinValuation {
  id            String    @id
  role          UserRole
  paisePerCoin  Int
  effectiveFrom DateTime  @default(now())
  effectiveTo   DateTime?
  setByUserId   String?
  createdAt     DateTime  @default(now())
  User          User?     @relation(fields: [setByUserId], references: [id])

  @@index([role, effectiveFrom])
  @@index([role, effectiveTo])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model ContentModeration {
  id          String    @id
  contentType String
  contentId   String
  flaggedBy   String?
  reason      String
  status      String    @default("PENDING")
  reviewedBy  String?
  reviewedAt  DateTime?
  createdAt   DateTime  @default(now())

  @@index([contentType, contentId])
  @@index([status])
}

/// ContentFlag - Tracks flagged content for moderation
model ContentFlag {
  id              String          @id
  contentType     ContentFlagType
  contentId       String
  vendorId        String?
  reason          FlagReason
  description     String?
  priority        FlagPriority    @default(LOW)
  status          FlagStatus      @default(PENDING)
  reportedBy      String?
  isAutoFlagged   Boolean         @default(false)
  reportCount     Int             @default(1)
  action          ModerationAction?
  moderationNotes String?
  moderatedBy     String?
  moderatedAt     DateTime?
  assignedTo      String?
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt
  Vendor          Vendor?         @relation(fields: [vendorId], references: [id], onDelete: SetNull)

  @@index([contentType, contentId])
  @@index([status])
  @@index([priority])
  @@index([vendorId])
  @@index([assignedTo])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Coupon {
  id             String    @id
  code           String    @unique
  description    String?
  discountType   String
  discountValue  Int
  minOrderAmount Int?      @default(0)
  maxDiscount    Int?
  validFrom      DateTime  @default(now())
  validUntil     DateTime?
  usageLimit     Int?
  usedCount      Int       @default(0)
  isActive       Boolean   @default(true)
  createdAt      DateTime  @default(now())
  updatedAt      DateTime
  categoryIds    String[]
  minQuantity    Int?
  productIds     String[]
  vendorId       String?
  Vendor         Vendor?   @relation(fields: [vendorId], references: [id])

  @@index([isActive])
  @@index([vendorId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model CreatorProfile {
  id              String   @id
  userId          String   @unique
  displayName     String
  bio             String?
  profileImageUrl String?
  isVerified      Boolean  @default(false)
  createdAt       DateTime @default(now())
  updatedAt       DateTime
  User            User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  Reel            Reel[]

  @@index([userId])
}

model Delivery {
  id              String         @id
  deliveryNumber  String         @unique
  orderId         String
  driverId        String?
  pickupAddress   Json
  deliveryAddress Json
  status          DeliveryStatus @default(PENDING)
  distance        Float?
  estimatedTime   Int?
  actualTime      Int?
  pickupOtp       String?
  deliveryOtp     String?
  pickedAt        DateTime?
  deliveredAt     DateTime?
  proofImage      String?
  notes           String?
  rating          Int?
  feedback        String?
  createdAt       DateTime       @default(now())
  updatedAt       DateTime
  Driver          Driver?        @relation(fields: [driverId], references: [id])
  Order           Order          @relation(fields: [orderId], references: [id])

  @@index([createdAt])
  @@index([driverId])
  @@index([orderId])
  @@index([status])
}

model Driver {
  id              String           @id
  driverId        String           @unique
  name            String
  mobile          String           @unique
  email           String?
  avatar          String?
  vehicleType     VehicleType
  vehicleNumber   String
  licenseNumber   String
  licenseExpiry   DateTime
  status          DriverStatus     @default(PENDING)
  isAvailable     Boolean          @default(false)
  isOnline        Boolean          @default(false)
  currentLocation Json?
  rating          Float            @default(5.0)
  totalDeliveries Int              @default(0)
  createdAt       DateTime         @default(now())
  updatedAt       DateTime
  Delivery        Delivery[]
  DriverDocument  DriverDocument[]

  @@index([isAvailable])
  @@index([isOnline])
  @@index([status])
}

model DriverDocument {
  id          String         @id
  driverId    String
  type        DocumentType
  documentUrl String
  status      DocumentStatus @default(PENDING)
  verifiedBy  String?
  verifiedAt  DateTime?
  expiryDate  DateTime?
  notes       String?
  createdAt   DateTime       @default(now())
  Driver      Driver         @relation(fields: [driverId], references: [id], onDelete: Cascade)

  @@index([driverId])
  @@index([status])
}

model Employee {
  id          String       @id
  employeeId  String       @unique
  name        String
  email       String       @unique
  mobile      String       @unique
  password    String
  avatar      String?
  role        EmployeeRole
  department  String?
  permissions String[]
  isActive    Boolean      @default(true)
  lastLoginAt DateTime?
  createdAt   DateTime     @default(now())
  updatedAt   DateTime

  @@index([department])
  @@index([isActive])
  @@index([role])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model GiftSKU {
  id                 String   @id
  title              String
  stock              Int      @default(0)
  cost               Int      @default(0)
  eligibleCategories Json?
  createdAt          DateTime @default(now())
  Order              Order[]
}

model Inventory {
  id              String          @id
  productId       String
  warehouseId     String?
  stock           Int             @default(0)
  reservedStock   Int             @default(0)
  reorderPoint    Int             @default(10)
  reorderQuantity Int             @default(50)
  createdAt       DateTime        @default(now())
  updatedAt       DateTime
  Product         Product         @relation(fields: [productId], references: [id])
  Warehouse       Warehouse?      @relation(fields: [warehouseId], references: [id])
  StockMovement   StockMovement[]

  @@index([productId])
  @@index([warehouseId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model LedgerEntry {
  id           String   @id
  userId       String
  walletId     String
  betId        String?
  amount       Int
  type         String
  description  String
  balanceAfter Int
  createdAt    DateTime @default(now())
  Bet          Bet?     @relation(fields: [betId], references: [id])
  User         User     @relation(fields: [userId], references: [id])
  Wallet       Wallet   @relation(fields: [walletId], references: [id])

  @@index([betId])
  @@index([createdAt])
  @@index([userId])
  @@index([walletId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model LocalPromotion {
  id            String    @id
  name          String?
  isActive      Boolean   @default(true)
  targetType    String
  centerLat     Float?
  centerLng     Float?
  radiusKm      Float?
  pincodes      Json?
  vendorId      String?
  categoryId    String?
  productId     String?
  percentOff    Int?
  flatOffAmount Int?
  freeShipping  Boolean   @default(false)
  boostOnly     Boolean   @default(false)
  effectiveFrom DateTime  @default(now())
  effectiveTo   DateTime?
  setByUserId   String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime
  Category      Category? @relation(fields: [categoryId], references: [id])
  Product       Product?  @relation(fields: [productId], references: [id])
  User          User?     @relation(fields: [setByUserId], references: [id])
  Vendor        Vendor?   @relation(fields: [vendorId], references: [id])

  @@index([categoryId])
  @@index([isActive, effectiveFrom, effectiveTo])
  @@index([productId])
  @@index([vendorId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Notification {
  id             String   @id
  userId         String?
  title          String
  body           String
  type           String
  targetAudience String?
  isRead         Boolean  @default(false)
  createdAt      DateTime @default(now())
  User           User?    @relation(fields: [userId], references: [id])

  @@index([userId, createdAt])
  @@index([userId, isRead])
}

model NotificationCampaign {
  id             String    @id
  name           String
  templateId     String?
  title          String
  body           String
  imageUrl       String?
  targetAudience Json
  scheduledAt    DateTime?
  sentAt         DateTime?
  totalSent      Int       @default(0)
  totalOpened    Int       @default(0)
  totalClicked   Int       @default(0)
  status         String    @default("draft")
  createdBy      String
  createdAt      DateTime  @default(now())
  updatedAt      DateTime

  @@index([createdAt])
  @@index([scheduledAt])
  @@index([status])
}

model NotificationTemplate {
  id        String   @id
  name      String   @unique
  title     String
  body      String
  imageUrl  String?
  action    String?
  data      Json?
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime

  @@index([isActive])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Order {
  id                                                       String                     @id
  userId                                                   String
  roomId                                                   String?
  addressId                                                String?
  items                                                    Json
  totalAmount                                              Int
  coinsUsed                                                Int                        @default(0)
  coinsUsedDebited                                         Boolean                    @default(false)
  status                                                   OrderStatus                @default(PENDING)
  razorpayOrderId                                          String?
  awbNumber                                                String?
  courierPartner                                           String?
  createdAt                                                DateTime                   @default(now())
  updatedAt                                                DateTime
  abandonedCheckoutId                                      String?
  agentId                                                  String?
  shippingCharges                                          Int                        @default(0)
  couponCode                                               String?
  discountAmount                                           Int                        @default(0)
  giftId                                                   String?
  deliveredAt                                              DateTime?
  isReturnable                                             Boolean                    @default(true)
  returnWindow                                             Int                        @default(7)
  obdOtp                                                   String?
  obdVerifiedAt                                            DateTime?
  obdFailedAt                                              DateTime?
  obdNotes                                                 String?
  checkoutGroupId                                          String?
  orderNumber                                              String?                    @unique
  invoiceNumber                                            String?                    @unique
  confirmedAt                                              DateTime?
  isThirdPartyDelivery                                     Boolean                    @default(false)
  trackingId                                               String?
  Delivery                                                 Delivery[]
  abandonedCheckout                                        AbandonedCheckout?         @relation(fields: [abandonedCheckoutId], references: [id])
  address                                                  Address?                   @relation(fields: [addressId], references: [id])
  checkoutGroup                                            CheckoutGroup?             @relation(fields: [checkoutGroupId], references: [id])
  giftSKU                                                  GiftSKU?                   @relation(fields: [giftId], references: [id])
  user                                                     User                       @relation(fields: [userId], references: [id])
  OrderDeliverySlotSnapshot                                OrderDeliverySlotSnapshot?
  OrderFinancialSnapshot                                   OrderFinancialSnapshot?
  OrderItem                                                OrderItem[]
  OrderPackingProof                                        OrderPackingProof?
  OrderSettlement                                          OrderSettlement?
  payment                                                  Payment?
  ReferralRewardGrant                                      ReferralRewardGrant?
  Refund                                                   Refund[]
  ReplacementOrder_ReplacementOrder_newOrderIdToOrder      ReplacementOrder?          @relation("ReplacementOrder_newOrderIdToOrder")
  ReplacementOrder_ReplacementOrder_originalOrderIdToOrder ReplacementOrder[]         @relation("ReplacementOrder_originalOrderIdToOrder")
  ReturnQCChecklist                                        ReturnQCChecklist?
  ReturnRequest                                            ReturnRequest[]
  Shipment                                                 Shipment?
  SupportTicket                                            SupportTicket[]
  VendorStrike                                             VendorStrike[]

  @@index([awbNumber])
  @@index([checkoutGroupId])
  @@index([createdAt])
  @@index([invoiceNumber])
  @@index([orderNumber])
  @@index([razorpayOrderId])
  @@index([roomId, userId])
  @@index([status, createdAt])
  @@index([status])
  @@index([userId])
  @@index([userId, status])
}

model ReturnQCChecklist {
  id          String   @id @default(cuid())
  orderId     String   @unique
  returnId    String?
  vendorId    String
  agentId     String
  isBrandBoxIntact Boolean @default(true)
  isProductIntact  Boolean @default(true)
  missingAccessories String[]
  images      String[]
  videoPath   String?
  status      String   @default("PASSED") // PASSED, FAILED
  notes       String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  order       Order    @relation(fields: [orderId], references: [id])
  vendor      Vendor   @relation(fields: [vendorId], references: [id])
  user        User     @relation(fields: [agentId], references: [id])

  @@index([orderId])
  @@index([vendorId])
  @@index([status])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model OrderDeliverySlotSnapshot {
  id          String             @id
  orderId     String             @unique
  vendorId    String
  slotStartAt DateTime
  slotEndAt   DateTime
  timezone    String             @default("Asia/Kolkata")
  source      DeliverySlotSource @default(AUTO)
  createdAt   DateTime           @default(now())
  Order       Order              @relation(fields: [orderId], references: [id], onDelete: Cascade)
  Vendor      Vendor             @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@index([vendorId, slotStartAt])
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model OrderFinancialSnapshot {
  id               String   @id
  orderId          String   @unique
  subtotal         Int
  taxAmount        Int
  shippingAmount   Int
  discountAmount   Int
  giftCost         Int
  commissionRate   Float
  commissionAmount Int
  vendorEarnings   Int
  platformEarnings Int
  currency         String   @default("INR")
  calculatedAt     DateTime @default(now())
  Order            Order    @relation(fields: [orderId], references: [id])

  @@index([orderId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model OrderPackingProof {
  id               String   @id
  orderId          String   @unique
  vendorId         String
  uploadedByUserId String
  videoPath        String
  videoMime        String?
  videoSizeBytes   Int?
  createdAt        DateTime @default(now())
  updatedAt        DateTime
  Order            Order    @relation(fields: [orderId], references: [id], onDelete: Cascade)
  User             User     @relation(fields: [uploadedByUserId], references: [id], onDelete: Cascade)
  Vendor           Vendor   @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@index([createdAt])
  @@index([vendorId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model OrderSettlement {
  id         String           @id
  orderId    String           @unique
  vendorId   String
  amount     Int
  status     SettlementStatus @default(PENDING)
  eligibleAt DateTime?
  settledAt  DateTime?
  createdAt  DateTime         @default(now())
  Order      Order            @relation(fields: [orderId], references: [id])
  Vendor     Vendor           @relation(fields: [vendorId], references: [id])

  @@index([vendorId, status])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Payment {
  id              String        @id
  orderId         String        @unique
  amount          Int
  currency        String        @default("INR")
  provider        String
  providerOrderId String?
  paymentId       String?
  status          PaymentStatus @default(PENDING)
  createdAt       DateTime      @default(now())
  updatedAt       DateTime
  Order           Order         @relation(fields: [orderId], references: [id])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model PaymentIntent {
  id              String               @id
  purpose         PaymentIntentPurpose
  referenceId     String
  amount          Int
  currency        String               @default("INR")
  provider        String               @default("RAZORPAY")
  providerOrderId String?
  paymentId       String?
  status          PaymentStatus        @default(PENDING)
  metadata        Json?
  createdByUserId String?
  createdAt       DateTime             @default(now())
  updatedAt       DateTime
  User            User?                @relation(fields: [createdByUserId], references: [id])

  @@unique([purpose, referenceId])
  @@index([createdByUserId, createdAt])
  @@index([providerOrderId])
  @@index([purpose, createdAt])
  @@index([status, createdAt])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model PickupPoint {
  id           String     @id
  vendorId     String
  name         String
  addressLine1 String
  addressLine2 String?
  city         String
  state        String
  pincode      String
  latitude     Float?
  longitude    Float?
  timings      Json?
  isActive     Boolean    @default(true)
  createdAt    DateTime   @default(now())
  updatedAt    DateTime
  Vendor       Vendor     @relation(fields: [vendorId], references: [id], onDelete: Cascade)
  Shipment     Shipment[]

  @@index([pincode])
  @@index([vendorId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model PincodeGeo {
  pincode   String    @id
  latitude  Float
  longitude Float
  source    GeoSource @default(PINCODE_DB)
  createdAt DateTime  @default(now())
  updatedAt DateTime
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model PlatformConfig {
  id          String   @id @default(cuid())
  category    String
  key         String
  value       Json
  description String?
  updatedById String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@unique([category, key])
  @@index([category])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Product {
  id                   String             @id
  vendorId             String
  title                String
  name                 String?            // Alias for title for compatibility
  description          String?
  price                Int
  offerPrice           Int?
  stock                Int                @default(0)
  categoryId           String
  images               String[]
  isWholesale          Boolean            @default(false)
  wholesalePrice       Int?
  moq                  Int                @default(1)
  isActive             Boolean            @default(false)
  createdAt            DateTime           @default(now())
  updatedAt            DateTime
  brandName            String?
  dimensionUnit        String?            @default("cm")
  height               Float?
  length               Float?
  metaDescription      String?
  metaKeywords         String[]
  metaTitle            String?
  shippingClass        String?
  sku                  String?            @unique
  tags                 String[]
  weight               Float?
  weightUnit           String?            @default("kg")
  width                Float?
  allergenInformation  String?
  attributes           Json?
  basePreparationTime  Int                @default(0)
  costPrice            Int?
  isAttachmentRequired Boolean            @default(false)
  isCancelable         Boolean            @default(false)
  isInclusiveTax       Boolean            @default(false)
  isReturnable         Boolean            @default(false)
  mediaGallery         Json?
  minOrderQuantity     Int                @default(1)
  quantityStepSize     Int                @default(1)
  requiresOTP          Boolean            @default(false)
  rulesSnapshot        Json?
  shippingDetails      Json?
  storageInstructions  String?
  totalAllowedQuantity Int                @default(10)
  freeListingExpiresAt DateTime?
  visibility           ProductVisibility  @default(DRAFT)
  popularityScore      Float              @default(0)
  embedding            Json?
  disableAutoClearance Boolean            @default(false)
  expiryDate           DateTime?
  BowActionLog         BowActionLog[]
  BuyLater             BuyLater[]
  CartItem             CartItem[]
  ClearanceProduct     ClearanceProduct[]
  Inventory            Inventory[]
  LocalPromotion       LocalPromotion[]
  CommissionRule       CommissionRule[]
  Category             Category           @relation(fields: [categoryId], references: [id])
  Vendor               Vendor             @relation(fields: [vendorId], references: [id])
  OrderItem            OrderItem[]
  ProductSpecValue     ProductSpecValue[]
  ProductVariant       ProductVariant[]
  Reel                 Reel[]
  ReturnItem           ReturnItem[]
  Review               Review[]
  Room                 Room[]
  UserProductEvent     UserProductEvent[]
  VendorInquiry        VendorInquiry[]
  Wishlist             Wishlist[]

  @@index([categoryId])
  @@index([categoryId, isActive, createdAt])
  @@index([categoryId, isActive])
  @@index([categoryId, isActive, price])
  @@index([createdAt])
  @@index([isActive, createdAt])
  @@index([isActive])
  @@index([isActive, price])
  @@index([price])
  @@index([sku])
  @@index([vendorId])
  @@index([vendorId, isActive])
  @@index([vendorId, stock])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model ProductSearchMiss {
  id                 String    @id
  query              String
  userId             String?
  count              Int       @default(1)
  lastSearchedAt     DateTime
  firstSearchedAt    DateTime  @default(now())
  inferredCategoryId String?
  keywords           String[]
  metadata           Json?
  normalizedQuery    String
  resolved           Boolean   @default(false)
  resolvedProductId  String?
  region             String?
  Category           Category? @relation(fields: [inferredCategoryId], references: [id])
  User               User?     @relation(fields: [userId], references: [id])

  @@index([count])
  @@index([lastSearchedAt])
  @@index([normalizedQuery])
  @@index([region])
  @@index([resolved])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model ProductSpecValue {
  id           String       @id
  productId    String
  specId       String
  value        String
  createdAt    DateTime     @default(now())
  updatedAt    DateTime
  Product      Product      @relation(fields: [productId], references: [id], onDelete: Cascade)
  CategorySpec CategorySpec @relation(fields: [specId], references: [id], onDelete: Cascade)

  @@unique([productId, specId])
  @@index([productId])
  @@index([specId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model ProductVariant {
  id         String          @id
  productId  String
  sku        String?         @unique
  attributes Json
  price      Int?
  stock      Int             @default(0)
  status     VariationStatus @default(ACTIVE)
  Product    Product         @relation(fields: [productId], references: [id])

  @@index([productId])
  @@index([stock])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model RecommendationEvent {
  id              String   @id
  userId          String
  source          String
  strategy        String
  productIds      String[]
  accepted        Boolean?
  cartValueBefore Int
  cartValueAfter  Int?
  createdAt       DateTime @default(now())
  User            User     @relation(fields: [userId], references: [id])

  @@index([accepted])
  @@index([strategy])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Reel {
  id                    String                  @id
  vendorId              String?
  creatorId             String?
  mediaUrl              String
  thumbnailUrl          String?
  productId             String?
  description           String?
  flaggedForReview      Boolean                 @default(false)
  createdAt             DateTime                @default(now())
  CreatorProfile        CreatorProfile?         @relation(fields: [creatorId], references: [id])
  Product               Product?                @relation(fields: [productId], references: [id])
  Vendor                Vendor?                 @relation(fields: [vendorId], references: [id])
  ReelInteractionLedger ReelInteractionLedger[]

  @@index([createdAt])
  @@index([creatorId])
  @@index([productId])
  @@index([vendorId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model ReelInteractionLedger {
  id              String   @id
  reelId          String
  userId          String
  interactionType String
  createdAt       DateTime @default(now())
  Reel            Reel     @relation(fields: [reelId], references: [id], onDelete: Cascade)
  User            User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([reelId, userId, interactionType])
  @@index([reelId, interactionType])
  @@index([userId, createdAt])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model ReferralRewardGrant {
  id                                           String             @id
  orderId                                      String             @unique
  inviterUserId                                String
  inviteeUserId                                String
  ruleId                                       String
  orderValuePaiseAtAward                       Int
  coinsInviterAtAward                          Int
  coinsInviteeAtAward                          Int
  createdAt                                    DateTime           @default(now())
  User_ReferralRewardGrant_inviteeUserIdToUser User               @relation("ReferralRewardGrant_inviteeUserIdToUser", fields: [inviteeUserId], references: [id], onDelete: Cascade)
  User_ReferralRewardGrant_inviterUserIdToUser User               @relation("ReferralRewardGrant_inviterUserIdToUser", fields: [inviterUserId], references: [id], onDelete: Cascade)
  Order                                        Order              @relation(fields: [orderId], references: [id], onDelete: Cascade)
  ReferralRewardRule                           ReferralRewardRule @relation(fields: [ruleId], references: [id])

  @@index([inviteeUserId, createdAt])
  @@index([inviterUserId, createdAt])
  @@index([ruleId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model ReferralRewardRule {
  id                  String                @id
  minOrderPaise       Int
  maxOrderPaise       Int?
  coinsInviter        Int
  coinsInvitee        Int
  isActive            Boolean               @default(true)
  effectiveFrom       DateTime              @default(now())
  effectiveTo         DateTime?
  setByAdminId        String?
  createdAt           DateTime              @default(now())
  updatedAt           DateTime
  ReferralRewardGrant ReferralRewardGrant[]
  User                User?                 @relation(fields: [setByAdminId], references: [id])

  @@index([isActive, effectiveFrom, effectiveTo])
  @@index([maxOrderPaise])
  @@index([minOrderPaise])
  @@index([setByAdminId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model ReferralTracking {
  id                                     String         @id
  referrerId                             String
  refereeId                              String
  referralCode                           String
  status                                 ReferralStatus @default(PENDING)
  coinsAwarded                           Int            @default(0)
  firstOrderId                           String?
  deviceFingerprint                      String?
  ipAddress                              String?
  createdAt                              DateTime       @default(now())
  completedAt                            DateTime?
  User_ReferralTracking_refereeIdToUser  User           @relation("ReferralTracking_refereeIdToUser", fields: [refereeId], references: [id], onDelete: Cascade)
  User_ReferralTracking_referrerIdToUser User           @relation("ReferralTracking_referrerIdToUser", fields: [referrerId], references: [id], onDelete: Cascade)

  @@index([refereeId])
  @@index([referralCode])
  @@index([referrerId])
  @@index([status])
}

model Refund {
  id              String         @id
  refundNumber    String         @unique
  orderId         String
  returnId        String?
  userId          String
  amount          Int
  reason          String
  status          RefundStatus   @default(PENDING)
  method          RefundMethod   @default(ORIGINAL_PAYMENT)
  transactionId   String?
  processedBy     String?
  processedAt     DateTime?
  rejectionReason String?
  notes           String?
  metadata        Json?
  createdAt       DateTime       @default(now())
  updatedAt       DateTime
  Order           Order          @relation(fields: [orderId], references: [id])
  ReturnRequest   ReturnRequest? @relation(fields: [returnId], references: [id])
  User            User           @relation(fields: [userId], references: [id])

  @@index([createdAt])
  @@index([orderId])
  @@index([refundNumber])
  @@index([returnId])
  @@index([status])
  @@index([userId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model ReplacementOrder {
  id                                            String        @id
  originalOrderId                               String
  returnId                                      String        @unique
  newOrderId                                    String        @unique
  createdAt                                     DateTime      @default(now())
  Order_ReplacementOrder_newOrderIdToOrder      Order         @relation("ReplacementOrder_newOrderIdToOrder", fields: [newOrderId], references: [id])
  Order_ReplacementOrder_originalOrderIdToOrder Order         @relation("ReplacementOrder_originalOrderIdToOrder", fields: [originalOrderId], references: [id])
  ReturnRequest                                 ReturnRequest @relation(fields: [returnId], references: [id])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Report {
  id          String   @id
  reporterId  String
  targetType  String
  targetId    String
  reason      String
  description String?
  status      String   @default("PENDING")
  createdAt   DateTime @default(now())
  updatedAt   DateTime
  User        User     @relation(fields: [reporterId], references: [id])

  @@index([reporterId])
  @@index([status])
  @@index([targetType])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model ReturnItem {
  id            String         @id
  returnId      String
  productId     String
  quantity      Int
  reason        ReturnReason?
  condition     String?
  description   String?
  qcNotes       String?
  qcStatus      ItemCondition?
  variantId     String?
  Product       Product        @relation(fields: [productId], references: [id])
  ReturnRequest ReturnRequest  @relation(fields: [returnId], references: [id])

  @@index([productId])
  @@index([returnId])
}



/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model ReturnRequest {
  id                    String            @id
  returnNumber          String            @unique
  orderId               String
  userId                String
  vendorId              String?
  status                ReturnStatus      @default(PENDING_APPROVAL)
  reason                ReturnReason
  description           String?
  evidenceImages        String[]
  evidenceVideo         String?
  requestedAt           DateTime          @default(now())
  updatedAt             DateTime
  pickupDate            DateTime?
  pickupAddress         Json?
  courierPartner        String?
  trackingId            String?
  qcNotes               String?
  qcBy                  String?
  replacementTrackingId String?
  approvedAt            DateTime?
  completedAt           DateTime?
  rejectedAt            DateTime?
  Refund                Refund[]
  ReplacementOrder      ReplacementOrder?
  ReturnItem            ReturnItem[]
  Order                 Order             @relation(fields: [orderId], references: [id])
  User                  User              @relation(fields: [userId], references: [id])
  Vendor                Vendor?           @relation(fields: [vendorId], references: [id])
  ReturnSettlement      ReturnSettlement?
  ReturnTimeline        ReturnTimeline[]

  @@index([orderId])
  @@index([returnNumber])
  @@index([status])
  @@index([userId])
  @@index([vendorId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model ReturnSettlement {
  id             String        @id
  returnId       String        @unique
  penaltyApplied Boolean       @default(false)
  penaltyAmount  Int           @default(0)
  adminNotes     String?
  createdAt      DateTime      @default(now())
  penaltyReason  String?
  updatedAt      DateTime
  costBearer     CostBearer    @default(PLATFORM)
  ReturnRequest  ReturnRequest @relation(fields: [returnId], references: [id])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model ReturnTimeline {
  id            String        @id
  returnId      String
  status        ReturnStatus
  action        String
  performedBy   String
  timestamp     DateTime      @default(now())
  notes         String?
  actorId       String?
  metadata      Json?
  ReturnRequest ReturnRequest @relation(fields: [returnId], references: [id])

  @@index([returnId])
  @@index([timestamp])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Review {
  id           String   @id
  userId       String
  productId    String?
  vendorId     String?
  rating       Int
  comment      String?
  images       String[]
  createdAt    DateTime @default(now())
  updatedAt    DateTime
  helpfulCount Int      @default(0)
  isVerified   Boolean  @default(false)
  status       String   @default("ACTIVE")
  Product      Product? @relation(fields: [productId], references: [id])
  User         User     @relation(fields: [userId], references: [id])
  Vendor       Vendor?  @relation(fields: [vendorId], references: [id])

  @@index([productId])
  @@index([productId, status])
  @@index([userId])
  @@index([vendorId])
  @@index([vendorId, status])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Room {
  id              String        @id
  name            String
  size            Int
  status          RoomStatus    @default(LOCKED)
  offerId         String        @default("")
  startAt         DateTime
  endAt           DateTime
  unlockMinOrders Int
  unlockMinValue  Int
  createdById     String?
  isSystemRoom    Boolean       @default(false)
  createdAt       DateTime      @default(now())
  memberCount     Int           @default(1)
  maxDiscount     Float?
  maxMembers      Int?
  productId       String?
  type            RoomType      @default(GOAL_BASED)
  User            User?         @relation(fields: [createdById], references: [id])
  Product         Product?      @relation(fields: [productId], references: [id])
  RoomBoost       RoomBoost[]
  RoomInsight     RoomInsight[]
  RoomMember      RoomMember[]

  @@index([createdById])
  @@index([productId])
  @@index([status, endAt])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model RoomBoost {
  id        String        @id
  roomId    String
  vendorId  String?
  type      RoomBoostType
  coinsCost Int
  startAt   DateTime
  endAt     DateTime
  isActive  Boolean       @default(true)
  createdAt DateTime      @default(now())
  Room      Room          @relation(fields: [roomId], references: [id])

  @@index([roomId])
  @@index([startAt, endAt])
  @@index([type, isActive])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model RoomInsight {
  id        String   @id
  roomId    String
  metric    String
  value     Float
  createdAt DateTime @default(now())
  Room      Room     @relation(fields: [roomId], references: [id])

  @@index([metric])
  @@index([roomId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model RoomMember {
  roomId String
  userId String
  status MemberStatus @default(PENDING)
  Room   Room         @relation(fields: [roomId], references: [id])
  User   User         @relation(fields: [userId], references: [id])

  @@id([roomId, userId])
  @@index([userId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model RoomPackage {
  id               String   @id
  vendorId         String
  packageType      String
  remainingCredits Int
  createdAt        DateTime @default(now())
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model SearchClick {
  id        String   @id
  query     String
  productId String
  userId    String?
  clickedAt DateTime @default(now())

  @@index([productId])
  @@index([query])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model SearchTrending {
  id       String   @id
  query    String
  region   String?  @default("global")
  count    Int      @default(1)
  lastSeen DateTime @default(now())

  @@unique([query, region])
  @@index([lastSeen])
  @@index([region, count])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Shipment {
  id              String       @id
  orderId         String       @unique
  mode            String
  status          String
  courierProvider String?
  awb             String?
  trackingUrl     String?
  pickupPointId   String?
  createdAt       DateTime     @default(now())
  updatedAt       DateTime
  Order           Order        @relation(fields: [orderId], references: [id], onDelete: Cascade)
  PickupPoint     PickupPoint? @relation(fields: [pickupPointId], references: [id])

  @@index([awb])
  @@index([pickupPointId])
}

model StockMovement {
  id          String            @id
  inventoryId String
  type        StockMovementType
  quantity    Int
  reason      String?
  reference   String?
  createdBy   String
  createdAt   DateTime          @default(now())
  Inventory   Inventory         @relation(fields: [inventoryId], references: [id])

  @@index([createdAt])
  @@index([inventoryId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Story {
  id               String   @id
  vendorId         String
  mediaUrl         String
  mediaType        String
  expiresAt        DateTime
  isActive         Boolean  @default(true)
  flaggedForReview Boolean  @default(false)
  createdAt        DateTime @default(now())
  Vendor           Vendor   @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@index([isActive, expiresAt])
  @@index([vendorId, expiresAt])
}

model SupportTicket {
  id              String          @id
  ticketNumber    String          @unique
  userId          String
  category        TicketCategory
  subject         String
  description     String
  priority        TicketPriority  @default(MEDIUM)
  status          TicketStatus    @default(OPEN)
  assignedTo      String?
  orderId         String?
  productId       String?
  vendorId        String?
  attachments     String[]
  tags            String[]
  createdAt       DateTime        @default(now())
  updatedAt       DateTime
  closedAt        DateTime?
  firstResponseAt DateTime?
  resolvedAt      DateTime?
  Admin           Admin?          @relation(fields: [assignedTo], references: [id])
  Order           Order?          @relation(fields: [orderId], references: [id])
  User            User            @relation(fields: [userId], references: [id])
  TicketMessage   TicketMessage[]

  @@index([assignedTo])
  @@index([category])
  @@index([createdAt])
  @@index([orderId])
  @@index([priority])
  @@index([status])
  @@index([userId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model TelecallerPerformance {
  id        String   @id
  agentId   String
  date      DateTime
  assigned  Int      @default(0)
  contacted Int      @default(0)
  converted Int      @default(0)
  dropped   Int      @default(0)
  User      User     @relation(fields: [agentId], references: [id])

  @@unique([agentId, date])
}

model TicketMessage {
  id            String        @id
  ticketId      String
  senderId      String
  senderType    MessageSender
  senderName    String
  message       String
  attachments   String[]
  isInternal    Boolean       @default(false)
  createdAt     DateTime      @default(now())
  SupportTicket SupportTicket @relation(fields: [ticketId], references: [id], onDelete: Cascade)

  @@index([createdAt])
  @@index([ticketId])
}

model TicketTemplate {
  id        String          @id
  name      String
  category  TicketCategory?
  subject   String?
  content   String
  isActive  Boolean         @default(true)
  createdAt DateTime        @default(now())
  updatedAt DateTime

  @@index([category])
  @@index([isActive])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model User {
  id                                                          String                   @id
  mobile                                                      String                   @unique
  phone                                                       String?                  // Alias for compatibility
  name                                                        String?
  email                                                       String?                  @unique
  password                                                    String?
  role                                                        UserRole                 @default(CUSTOMER)
  status                                                      UserStatus               @default(ACTIVE)
  coinsBalance                                                Int                      @default(0)
  referralCode                                                String                   @unique
  referredBy                                                  String?
  dateOfBirth                                                 DateTime?
  gender                                                      String?
  size                                                        String?
  footwearSize                                                Int?
  stylePrefs                                                  String?
  colors                                                      String?
  riskTag                                                     RiskTag                  @default(LOW)
  valueTag                                                    ValueTag                 @default(NORMAL)
  isCodDisabled                                               Boolean                  @default(false)
  isRefundsDisabled                                           Boolean                  @default(false)
  createdAt                                                   DateTime                 @default(now())
  forceLogoutAt                                               DateTime?
  kycDocuments                                                Json?
  kycStatus                                                   String                   @default("NOT_SUBMITTED")
  miscDocuments                                               Json?
  updatedAt                                                   DateTime
  metadata                                                    Json?                    @default("{}")
  AbandonedCheckout_AbandonedCheckout_agentIdToUser           AbandonedCheckout[]      @relation("AbandonedCheckout_agentIdToUser")
  AbandonedCheckout_AbandonedCheckout_userIdToUser            AbandonedCheckout[]      @relation("AbandonedCheckout_userIdToUser")
  Address                                                     Address[]
  AdminNote_AdminNote_adminIdToUser                           AdminNote[]              @relation("AdminNote_adminIdToUser")
  AdminNote_AdminNote_userIdToUser                            AdminNote[]              @relation("AdminNote_userIdToUser")
  AuditLog                                                    AuditLog[]
  BannerImpressionLedger                                      BannerImpressionLedger[]
  Bet                                                         Bet[]
  BowActionLog                                                BowActionLog[]
  BowInteraction                                              BowInteraction[]
  BuyLater                                                    BuyLater[]
  Cart                                                        Cart?
  CartInsight                                                 CartInsight[]
  CheckoutFollowup                                            CheckoutFollowup[]
  CheckoutGroup                                               CheckoutGroup[]
  CoinLedger                                                  CoinLedger[]
  CoinValuation                                               CoinValuation[]
  CreatorProfile                                              CreatorProfile?
  LedgerEntry                                                 LedgerEntry[]
  LocalPromotion                                              LocalPromotion[]
  Notification                                                Notification[]
  Order                                                       Order[]
  OrderPackingProof                                           OrderPackingProof[]
  PaymentIntent                                               PaymentIntent[]
  ProductSearchMiss                                           ProductSearchMiss[]
  RecommendationEvent                                         RecommendationEvent[]
  ReelInteractionLedger                                       ReelInteractionLedger[]
  ReferralRewardGrant_ReferralRewardGrant_inviteeUserIdToUser ReferralRewardGrant[]    @relation("ReferralRewardGrant_inviteeUserIdToUser")
  ReferralRewardGrant_ReferralRewardGrant_inviterUserIdToUser ReferralRewardGrant[]    @relation("ReferralRewardGrant_inviterUserIdToUser")
  ReferralRewardRule                                          ReferralRewardRule[]
  ReferralTracking_ReferralTracking_refereeIdToUser           ReferralTracking[]       @relation("ReferralTracking_refereeIdToUser")
  ReferralTracking_ReferralTracking_referrerIdToUser          ReferralTracking[]       @relation("ReferralTracking_referrerIdToUser")
  Refund                                                      Refund[]
  Report                                                      Report[]
  ReturnRequest                                               ReturnRequest[]
  ReturnQCChecklists                                          ReturnQCChecklist[]
  Review                                                      Review[]
  Room                                                        Room[]
  RoomMember                                                  RoomMember[]
  SupportTicket                                               SupportTicket[]
  TelecallerPerformance                                       TelecallerPerformance[]
  UserDevice                                                  UserDevice[]
  UserPreferenceProfile                                       UserPreferenceProfile?
  UserProductEvent                                            UserProductEvent[]
  VendorFollower                                              VendorFollower[]
  VendorInquiry                                               VendorInquiry[]
  Wallet                                                      Wallet?
  Wishlist                                                    Wishlist[]

  @@index([referredBy])
  @@index([role])
  @@index([status])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model UserDevice {
  id         String   @id
  userId     String
  platform   String
  token      String   @unique
  isActive   Boolean  @default(true)
  lastSeenAt DateTime @default(now())
  createdAt  DateTime @default(now())
  updatedAt  DateTime
  User       User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([lastSeenAt])
  @@index([userId, isActive])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model UserPreferenceProfile {
  id                  String   @id
  userId              String   @unique
  preferredCategories String[]
  preferredBrands     String[]
  sizePreferences     String[]
  priceSensitivity    String   @default("MEDIUM")
  colorAffinity       String[]
  styleTags           String[]
  lastUpdated         DateTime
  confidenceScore     Float    @default(0.1)
  User                User     @relation(fields: [userId], references: [id])

  @@index([priceSensitivity])
  @@index([userId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model UserProductEvent {
  id        String               @id
  userId    String?
  sessionId String?
  type      UserProductEventType
  source    String?
  productId String
  variantId String?
  quantity  Int?
  price     Int?
  metadata  Json?
  createdAt DateTime             @default(now())
  Product   Product              @relation(fields: [productId], references: [id])
  User      User?                @relation(fields: [userId], references: [id])

  @@index([productId, createdAt])
  @@index([source, createdAt])
  @@index([type, createdAt])
  @@index([userId, createdAt])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Vendor {
  id                              String                      @id
  name                            String
  mobile                          String                      @unique
  email                           String?
  isActive                        Boolean                     @default(true) // Alias for storeStatus compatibility
  kycStatus                       String                      @default("PENDING")
  tier                            String                      @default("BASIC")
  gstNumber                       String?
  isGstVerified                   Boolean                     @default(false)
  kycDocuments                    Json?
  skuLimit                        Int                         @default(100)
  role                            VendorRole                  @default(RETAILER)
  coinsBalance                    Int                         @default(0)
  followCount                     Int                         @default(0)
  vendorCode                      String?                     @unique
  commissionRate                  Float                       @default(0.0)
  createdAt                       DateTime                    @default(now())
  updatedAt                       DateTime
  bankDetails                     Json?
  lastPayoutDate                  DateTime?
  pendingEarnings                 Int                         @default(0)
  performanceScore                Float                       @default(0.0)
  pickupEnabled                   Boolean                     @default(false)
  pickupTimings                   Json?
  storeBanner                     String?
  storeLogo                       String?
  storeName                       String?
  storeTimings                    Json?
  commissionOverride              Decimal?                    @db.Decimal(5, 4)
  latitude                        Float?
  longitude                       Float?
  pincode                         String?
  storeClosedUntil                DateTime?
  autoClearanceThresholdDays      Int?                        @default(7)
  defaultClearanceDiscountPercent Int?                        @default(20)
  storeStatus                     String?                     @default("ACTIVE")
  ClearanceProduct                ClearanceProduct[]
  Coupon                          Coupon[]
  LocalPromotion                  LocalPromotion[]
  OrderDeliverySlotSnapshot       OrderDeliverySlotSnapshot[]
  OrderItem                       OrderItem[]
  OrderPackingProof               OrderPackingProof[]
  OrderSettlement                 OrderSettlement[]
  PickupPoint                     PickupPoint[]
  Product                         Product[]
  Reel                            Reel[]
  ReturnRequest                   ReturnRequest[]
  ReturnQCChecklists              ReturnQCChecklist[]
  Review                          Review[]
  Story                           Story[]
  VendorBowCoinLedger             VendorBowCoinLedger[]
  VendorDeliveryWindow            VendorDeliveryWindow[]
  VendorDisciplineEvent           VendorDisciplineEvent[]
  VendorDisciplineState           VendorDisciplineState?
  VendorDocument                  VendorDocument[]
  VendorFollower                  VendorFollower[]
  VendorInquiry                   VendorInquiry[]
  VendorMembership                VendorMembership?
  VendorPayout                    VendorPayout[]
  VendorPromotion                 VendorPromotion[]
  VendorServiceArea               VendorServiceArea[]
  VendorStrike                    VendorStrike[]
  VendorDiscipline                VendorDiscipline[]
  CommissionRule                 CommissionRule[]
  ContentFlag                     ContentFlag[]

  @@index([kycStatus])
  @@index([pincode])
  @@index([tier])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model VendorBowCoinLedger {
  id           String   @id
  vendorId     String
  sourceType   String
  sourceId     String?
  coinsDelta   Int
  balanceAfter Int
  createdAt    DateTime @default(now())
  Vendor       Vendor   @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@index([sourceType, sourceId])
  @@index([vendorId, createdAt])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model VendorDeliveryWindow {
  id          String   @id
  vendorId    String
  weekday     Int
  startMinute Int
  endMinute   Int
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime
  Vendor      Vendor   @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@index([vendorId, isActive])
  @@index([vendorId, weekday, isActive])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model VendorDisciplineEvent {
  id          String   @id
  vendorId    String
  eventType   String
  orderId     String?
  reason      String?
  performedBy String?
  createdAt   DateTime @default(now())
  Vendor      Vendor   @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@index([eventType])
  @@index([vendorId, createdAt])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model VendorDisciplineState {
  vendorId             String   @id
  state                String
  activeStrikes        Int      @default(0)
  consecutiveSuccesses Int      @default(0)
  lastStateChange      DateTime @default(now())
  updatedAt            DateTime
  Vendor               Vendor   @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@index([state])
}

/// VendorStrike - Tracks strikes/violations issued to vendors
model VendorStrike {
  id              String            @id
  vendorId        String
  type            StrikeType
  reason          String
  evidence        String[]          @default([])
  orderId         String?
  productId       String?
  issuedBy        String
  issuedAt        DateTime          @default(now())
  points          Int               @default(1)
  resolution      StrikeResolution?
  resolutionNotes String?
  resolvedAt      DateTime?
  resolvedBy      String?
  appealedAt      DateTime?
  appealReason    String?
  appealEvidence  String[]          @default([])
  createdAt       DateTime          @default(now())
  updatedAt       DateTime          @updatedAt
  Vendor          Vendor            @relation(fields: [vendorId], references: [id], onDelete: Cascade)
  Order           Order?            @relation(fields: [orderId], references: [id], onDelete: SetNull)

  @@index([vendorId])
  @@index([type])
  @@index([resolution])
  @@index([orderId])
}

/// VendorDiscipline - Tracks discipline actions taken against vendors
model VendorDiscipline {
  id         String           @id
  vendorId   String
  status     DisciplineStatus
  reason     String
  startedAt  DateTime         @default(now())
  endsAt     DateTime?
  endedAt    DateTime?
  appliedBy  String
  liftedBy   String?
  liftReason String?
  createdAt  DateTime         @default(now())
  updatedAt  DateTime         @updatedAt
  Vendor     Vendor           @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@index([vendorId])
  @@index([status])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model VendorDocument {
  id              String    @id
  vendorId        String
  documentType    String
  documentUrl     String
  status          String    @default("PENDING")
  uploadedAt      DateTime  @default(now())
  reviewedAt      DateTime?
  reviewedBy      String?
  rejectionReason String?
  Vendor          Vendor    @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@index([status])
  @@index([vendorId, status])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model VendorFollower {
  vendorId  String
  userId    String
  createdAt DateTime @default(now())
  User      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  Vendor    Vendor   @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@id([vendorId, userId])
  @@index([userId])
  @@index([vendorId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model VendorInquiry {
  id                 String        @id
  wholesalerVendorId String
  requesterUserId    String
  productId          String
  quantity           Int
  message            String?
  status             InquiryStatus @default(PENDING)
  response           String?
  respondedAt        DateTime?
  createdAt          DateTime      @default(now())
  updatedAt          DateTime
  Product            Product       @relation(fields: [productId], references: [id], onDelete: Cascade)
  User               User          @relation(fields: [requesterUserId], references: [id], onDelete: Cascade)
  Vendor             Vendor        @relation(fields: [wholesalerVendorId], references: [id], onDelete: Cascade)

  @@index([createdAt])
  @@index([productId])
  @@index([requesterUserId, status])
  @@index([wholesalerVendorId, status])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model VendorMembership {
  id             String         @id
  vendorId       String         @unique
  tier           MembershipTier @default(FREE)
  price          Int            @default(0)
  skuLimit       Int            @default(10)
  imageLimit     Int            @default(3)
  commissionRate Float          @default(0.15)
  payoutCycle    PayoutCycle    @default(MONTHLY)
  features       Json?
  startDate      DateTime       @default(now())
  endDate        DateTime?
  isActive       Boolean        @default(true)
  autoRenew      Boolean        @default(false)
  createdAt      DateTime       @default(now())
  updatedAt      DateTime
  Vendor         Vendor         @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@index([isActive])
  @@index([tier])
  @@index([vendorId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model VendorPayout {
  id            String       @id
  vendorId      String
  amount        Int
  period        String
  status        PayoutStatus @default(PENDING)
  bankDetails   Json
  transactionId String?
  processedAt   DateTime?
  createdAt     DateTime     @default(now())
  updatedAt     DateTime
  Vendor        Vendor       @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@index([createdAt])
  @@index([status])
  @@index([vendorId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model VendorPromotion {
  id          String          @id
  vendorId    String
  type        PromotionType
  packageType String?
  productIds  String[]
  startDate   DateTime
  endDate     DateTime
  coinsCost   Int             @default(0)
  moneyCost   Int?
  status      PromotionStatus @default(ACTIVE)
  impressions Int             @default(0)
  clicks      Int             @default(0)
  orders      Int             @default(0)
  revenue     Int             @default(0)
  createdAt   DateTime        @default(now())
  updatedAt   DateTime
  metadata    Json?
  Vendor      Vendor          @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@index([startDate, endDate])
  @@index([status])
  @@index([type])
  @@index([vendorId])
  @@index([vendorId, status])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model VendorServiceArea {
  id        String   @id
  vendorId  String
  type      String
  centerLat Float?
  centerLng Float?
  radiusKm  Float?
  polygon   Json?
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime
  Vendor    Vendor   @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@index([isActive])
  @@index([vendorId])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Wallet {
  id          String        @id
  userId      String        @unique
  balance     Int           @default(0)
  createdAt   DateTime      @default(now())
  updatedAt   DateTime
  LedgerEntry LedgerEntry[]
  User        User          @relation(fields: [userId], references: [id])

  @@index([userId])
}

model Warehouse {
  id        String      @id
  name      String
  location  String
  isActive  Boolean     @default(true)
  createdAt DateTime    @default(now())
  updatedAt DateTime
  Inventory Inventory[]
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model WeeklyOffer {
  id        String   @id
  name      String
  startAt   DateTime
  endAt     DateTime
  isActive  Boolean  @default(true)
  rules     Json?
  createdAt DateTime @default(now())
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Wishlist {
  id        String   @id
  userId    String
  productId String
  createdAt DateTime @default(now())
  Product   Product  @relation(fields: [productId], references: [id])
  User      User     @relation(fields: [userId], references: [id])

  @@unique([userId, productId])
}

enum AdminRole {
  SUPER_ADMIN
  OPERATIONS_ADMIN
  FINANCE_ADMIN
  CONTENT_MODERATOR
  ANALYTICS_VIEWER
}

enum AttributeScope {
  PRODUCT
  VARIATION
}

enum BannerCampaignStatus {
  DRAFT
  PENDING_PAYMENT
  PAYMENT_RECEIVED
  PENDING_APPROVAL
  APPROVED
  ACTIVE
  PAUSED
  EXPIRED
  REJECTED
  DEACTIVATED
}

enum BannerType {
  HOMEPAGE_HERO
  CATEGORY_SPOTLIGHT
  SEARCH_RESULT
  STORY_PROMOTION
  WEEKLY_STANDARD
  MONTHLY_PREMIUM
}

enum BetStatus {
  PENDING
  PLACED
  SETTLED_WIN
  SETTLED_LOSE
  CANCELLED
  VOIDED
}

enum BetType {
  SINGLE
  MULTIPLE
  SYSTEM
}

enum BowActionType {
  ADD_TO_CART
  REMOVE_FROM_CART
  UPDATE_QUANTITY
  APPLY_COUPON
  SELECT_GIFT
  NAVIGATE
  VIEW_CART
  GET_RECOMMENDATIONS
  CLIENT_CONTROL
  ROOM_NUDGE
  SUGGEST_BUNDLE
  SUGGEST_GIFT
  SUGGEST_UPSELL
  REMOVE_SUGGESTION
}

enum CallOutcome {
  NOT_REACHABLE
  FOLLOW_UP_SCHEDULED
  CONVERTED
  DROPPED
  WRONG_NUMBER
}

enum CartInsightType {
  HESITATION
  THRESHOLD_NEAR
  BUNDLE_OPPORTUNITY
  PRICE_SENSITIVITY
  REPEAT_REMOVAL
  GIFT_ELIGIBLE
}

enum CheckoutGroupStatus {
  PENDING_PAYMENT
  PAID
  FAILED
}

enum CheckoutRecoveryStatus {
  NEW
  ASSIGNED
  FOLLOW_UP
  CONVERTED
  DROPPED
}

enum ContentFlagType {
  STORY
  REEL
  PRODUCT_IMAGE
  REVIEW
  VENDOR_PROFILE
  PRODUCT
  BANNER
}

enum CostBearer {
  PLATFORM
  VENDOR
  CUSTOMER
  SHARED
}

enum DeliverySlotSource {
  AUTO
  CUSTOMER
}

enum DeliveryStatus {
  PENDING
  ASSIGNED
  ACCEPTED
  PICKING_UP
  PICKED_UP
  IN_TRANSIT
  ARRIVED
  DELIVERED
  FAILED
  CANCELLED
}

enum DisciplineStatus {
  GOOD_STANDING
  WARNING
  PROBATION
  SUSPENDED
  FINAL_WARNING
  BLOCKED
  ACTIVE
  BANNED
  LIFTED
  EXPIRED
}

enum DocumentStatus {
  PENDING
  APPROVED
  REJECTED
}

enum DocumentType {
  AADHAAR
  PAN
  LICENSE
  RC_BOOK
  INSURANCE
}

enum DriverStatus {
  PENDING
  DOCUMENTS_SUBMITTED
  VERIFIED
  ACTIVE
  SUSPENDED
  BLOCKED
}

enum EmployeeRole {
  TELECALLER
  SUPPORT_AGENT
  CONTENT_MODERATOR
  WAREHOUSE_STAFF
  FINANCE_STAFF
  OPERATIONS_MANAGER
}

enum FlagPriority {
  LOW
  MEDIUM
  HIGH
  CRITICAL
}

enum FlagReason {
  NUDITY
  VIOLENCE
  HATE_SPEECH
  COUNTERFEIT
  PROHIBITED_ITEM
  MISLEADING
  SPAM
  COPYRIGHT
  TRADEMARK
  HARASSMENT
  MISINFORMATION
  OTHER
  INAPPROPRIATE
  PROHIBITED
  OFFENSIVE
  LOW_QUALITY
  DUPLICATE
}

enum FlagStatus {
  PENDING
  IN_REVIEW
  UNDER_REVIEW
  RESOLVED
  ESCALATED
}

enum GeoSource {
  PINCODE_DB
  NOMINATIM
  MANUAL
}

enum InquiryStatus {
  PENDING
  RESPONDED
  ACCEPTED
  REJECTED
  EXPIRED
}

enum InsightSeverity {
  LOW
  MEDIUM
  HIGH
}

enum InteractionType {
  CHAT
  VOICE
  RECOMMENDATION
  ACTION
}

enum InvoiceStatus {
  DRAFT
  GENERATED
  SENT
  PAID
  OVERDUE
  CANCELLED
}

enum InvoiceType {
  BANNER_CAMPAIGN
  SUBSCRIPTION
  COMMISSION
  REFUND
  ORDER
}

enum ItemCondition {
  UNOPENED
  OPENED_UNUSED
  USED_LIKE_NEW
  USED_GOOD
  USED_FAIR
  DAMAGED
  DEFECTIVE
}

enum MediaType {
  IMAGE
  VIDEO
  GIF
}

enum MemberStatus {
  PENDING
  ORDERED
  CONFIRMED
  CANCELLED
}

enum MembershipTier {
  FREE
  BASIC
  PRO
  PREMIUM
  ELITE
}

enum MenuLocation {
  HEADER
  FOOTER
  MOBILE_NAV
  SIDEBAR
}

enum MessageSender {
  CUSTOMER
  VENDOR
  ADMIN
  SYSTEM
}

enum ModerationAction {
  APPROVED
  REMOVED
  REMOVED_WITH_WARNING
  REMOVED_WITH_STRIKE
  ESCALATED
  APPROVE
  REMOVE
  HIDE
  EDIT
  WARN
}

enum OrderStatus {
  PENDING
  CONFIRMED
  PACKED
  SHIPPED
  DELIVERED
  CANCELLED
  CREATED
  PENDING_PAYMENT
  PAID
  OUT_FOR_INSPECTION
  RETURN_REQUESTED
  QC_IN_PROGRESS
  RETURN_PICKED_UP
  RETURN_RECEIVED
  RETURNED
  REFUNDED
}

enum PaymentIntentPurpose {
  BANNER_SLOT
  ROOM_PROMOTION
  VENDOR_MEMBERSHIP
}

enum PaymentStatus {
  PENDING
  SUCCESS
  FAILED
  REFUNDED
}

enum PayoutCycle {
  WEEKLY
  BIWEEKLY
  MONTHLY
  INSTANT
}

enum PayoutStatus {
  PENDING
  PROCESSING
  COMPLETED
  FAILED
}

enum PostStatus {
  DRAFT
  REVIEW
  SCHEDULED
  PUBLISHED
  ARCHIVED
}

enum ProductVisibility {
  DRAFT
  PUBLISHED
  BLOCKED
}

enum PromotionStatus {
  ACTIVE
  PAUSED
  COMPLETED
  CANCELLED
}

enum PromotionType {
  BANNER
  ROOM_PACKAGE
  FEATURED
}

enum ReferralStatus {
  PENDING
  COMPLETED
  EXPIRED
}

enum RefundMethod {
  ORIGINAL_PAYMENT
  WALLET
  BANK_TRANSFER
  UPI
}

enum RefundStatus {
  PENDING
  APPROVED
  REJECTED
  PROCESSED
  FAILED
}

enum ReturnReason {
  DAMAGED_PRODUCT
  WRONG_ITEM
  MISSING_PARTS
  QUALITY_ISSUE
  SIZE_FIT_ISSUE
  OTHER
  NOT_AS_DESCRIBED
  DEFECTIVE
  CHANGED_MIND
}

enum ReturnStatus {
  PENDING_APPROVAL
  APPROVED
  REJECTED
  PICKUP_SCHEDULED
  PICKUP_COMPLETED
  IN_TRANSIT
  RECEIVED_AT_WAREHOUSE
  QC_IN_PROGRESS
  QC_PASSED
  QC_FAILED
  REFUND_INITIATED
  REFUND_COMPLETED
  REPLACEMENT_INITIATED
  REPLACEMENT_SHIPPED
  REPLACEMENT_COMPLETED
  CANCELLED
}

enum ReviewStatus {
  ACTIVE
  REPORTED
  HIDDEN
  DELETED
  PENDING
  APPROVED
  REJECTED
}

enum RiskTag {
  LOW
  MEDIUM
  HIGH
}

enum RoomBoostType {
  PRIORITY_VISIBILITY
  UNLOCK_ACCELERATOR
  SPONSORED_PRODUCT
}

enum RoomStatus {
  LOCKED
  ACTIVE
  UNLOCKED
  EXPIRED
  OPEN
  COMPLETED
}

enum RoomType {
  GOAL_BASED
  LINEAR_DISCOUNT
}

enum SettlementStatus {
  PENDING
  ELIGIBLE
  SETTLED
  REVERSED
}

enum CommissionScope {
  PRODUCT
  VENDOR
  CATEGORY
  GLOBAL
}

enum SpecType {
  TEXT
  NUMBER
  SELECT
  BOOLEAN
  MULTISELECT
}

enum StockMovementType {
  IN
  OUT
  ADJUSTMENT
  TRANSFER
}

enum StrikeResolution {
  REMOVED
  UPHELD
  REDUCED
  APPEALED
  DECAYED
  OVERTURNED
}

enum StrikeType {
  FAILED_DELIVERY
  SHOP_CLOSED
  LATE_PREPARATION
  CUSTOMER_COMPLAINT
  QUALITY_ISSUE
  REPEATED_CANCELLATION
  POLICY_VIOLATION
  CONTENT_VIOLATION
  WARNING
  PRODUCT_VIOLATION
  DELIVERY_FAILURE
  FRAUD
  REPEATED_OFFENSE
}

enum TicketCategory {
  ORDER_ISSUE
  PAYMENT_ISSUE
  RETURN_REFUND
  PRODUCT_INQUIRY
  DELIVERY_ISSUE
  VENDOR_COMPLAINT
  TECHNICAL_ISSUE
  ACCOUNT_ISSUE
  OTHER
}

enum TicketPriority {
  LOW
  MEDIUM
  HIGH
  URGENT
}

enum TicketStatus {
  OPEN
  IN_PROGRESS
  WAITING_CUSTOMER
  WAITING_VENDOR
  ESCALATED
  RESOLVED
  CLOSED
}

enum UserProductEventType {
  PRODUCT_VIEW
  PRODUCT_CLICK
  ADD_TO_CART
  REMOVE_FROM_CART
  WISHLIST_ADD
  PURCHASE
}

enum UserRole {
  CUSTOMER
  VENDOR
  WHOLESALER
  ADMIN
  SUPER_ADMIN
  TELECALLER
}

enum UserStatus {
  ACTIVE
  SUSPENDED
  PENDING
  BANNED
}

enum ValueTag {
  NORMAL
  VIP
}

enum VariationStatus {
  ACTIVE
  OUT_OF_STOCK
  ARCHIVED
}

enum VehicleType {
  BIKE
  SCOOTER
  CAR
  VAN
  TRUCK
}

enum VendorRole {
  RETAILER
  WHOLESALER
}

enum VendorStatus {
  ACTIVE
  SUSPENDED
}
